@page
@model IndexModel
@{
    ViewData["Title"] = "Jogo da Velha";
}

<div class="container py-4">
    <h1 class="mb-3">Jogo da Velha</h1>

    <div class="mb-2" aria-live="polite">
        <strong>
            @if (Model.Status == TicTacToe.Domain.GameStatus.InProgress)
            {
                <text>Vez de @Model.CurrentPlayer</text>
            }
            else if (Model.Status == TicTacToe.Domain.GameStatus.XWon)
            {
                <text>Vitória de X</text>
            }
            else if (Model.Status == TicTacToe.Domain.GameStatus.OWon)
            {
                <text>Vitória de O</text>
            }
            else
            {
                <text>Empate</text>
            }
        </strong>
    </div>

    @if (!string.IsNullOrWhiteSpace(Model.Error))
    {
        <div class="alert alert-warning" role="alert">@Model.Error</div>
    }

    <div class="d-inline-block">
        @for (var r = 0; r < TicTacToe.Domain.Board.Size; r++)
        {
            <div class="d-flex">
                @for (var c = 0; c < TicTacToe.Domain.Board.Size; c++)
                {
                    var cell = Model.Board[r, c];
                    var disabled = cell != null || Model.Status != TicTacToe.Domain.GameStatus.InProgress;
                    var label = cell?.ToString() ?? "vazio";
                    var aria = $"Linha {r + 1}, Coluna {c + 1}, {(cell == null ? "vazio" : $"ocupado por {label}")}";

                    <form method="post" asp-page-handler="Move" class="m-1">
                        <input type="hidden" name="row" value="@r" />
                        <input type="hidden" name="col" value="@c" />
                        <button type="submit" class="btn btn-outline-primary" style="width:4rem;height:4rem;font-size:1.5rem;" aria-label="@aria" @(disabled ? "disabled" : null)>@label</button>
                    </form>
                }
            </div>
        }
    </div>

    <div class="mt-3">
        <form method="post" asp-page-handler="Reset">
            <button class="btn btn-secondary" type="submit" aria-label="Reiniciar partida">Reiniciar</button>
        </form>
    </div>
</div>
